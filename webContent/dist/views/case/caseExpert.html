<!--
 * @Author: cwx
 * @Description: slideCenter
 * @Date: 2021-10-21 17:41:07
 * @LastEditTime: 2022-05-27 18:05:30
 * @FilePath: \ReportSystem_Demo\webContent\dist\views\case\caseExpert.html
-->
<div class="layui-card layadmin-header">
    <div class="layui-breadcrumb" lay-filter="breadcrumb">
        <a lay-href="">主页</a>
        <a><cite>病例管理</cite></a>
    </div>
</div>

<div class="layui-fluid">
    <div class="layui-row layui-col-space10">

        <div class="layui-card">
            <div class="layui-card-header">病例列表（专家端）</div>
            <div class="layui-card-body">
                <!-- <div class="layui-btn-container case-table-btn">
                    <button class="layui-btn layui-btn-sm" data-type="exportCase">导出病例</button>
                    <button class="layui-btn layui-btn-sm" data-type="exportCase">导出病例</button>
                </div> -->
                <table class="layui-show" id="case-table" lay-filter="case-table"></table>
                <script type="text/html" id="table-toolbar" lay-filter="table-toolbar">
                    <a class="layui-btn layui-btn-xs" lay-event="diagnose">诊断</a>
                    <!-- <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a> -->
                    <a class="layui-btn layui-btn-xs layui-btn-normal" lay-event="openReport">查看报告</a>
                </script>
            </div>
        </div>
    </div>
</div>

<script>
    layui.use(['admin', 'form', 'laydate', 'table', 'view'], function () {
        var $ = layui.$,
            admin = layui.admin,
            element = layui.element,
            layer = layui.layer,
            laydate = layui.laydate,
            table = layui.table,
            view = layui.view,
            form = layui.form;

        table.render({
            elem: '#case-table',
            url: 'api/case/expertTable', //使用后端数据
            height: 'full-320',
            response: {
                statusCode: 200
            },
            where: {
                userName: layui.data('layuiAdmin').userName,
            },
            cols: [
                [{
                        field: 'radio',
                        type: 'radio',
                        fixed: 'left'
                    },
                    {
                        field: 'pathologyNum',
                        title: '病理号',
                        minWidth: 120
                    }, {
                        field: 'status',
                        title: '状态',
                        minWidth: 120
                    }, {
                        field: 'patName',
                        title: '病人信息',
                        minWidth: 120
                    }, {
                        field: 'hosName',
                        title: '医院名',
                        minWidth: 120
                    }, {
                        field: 'doctor',
                        title: '医生名',
                        minWidth: 120
                    }, {
                        field: 'subspecialty',
                        title: '亚专科',
                        minWidth: 120
                    }, {
                        field: 'date',
                        title: '上传时间',
                        minWidth: 120
                    }, {
                        title: "操作",
                        width: 180,
                        align: "center",
                        fixed: "right",
                        toolbar: "#table-toolbar"
                    }
                ]
            ],
            page: true,
            limit: 20,
        });


        //工具条事件
        table.on('tool(case-table)', function (obj) { //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
            var data = obj.data; //获得当前行数据
            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
            var tr = obj.tr; //获得当前行 tr 的 DOM 对象（如果有的话）

            if (layEvent === '') { //查看
            } else if (layEvent === 'diagnose') { //诊断
                if (data.status === '诊断完成'){
                    layer.msg('诊断已完成');
                }
                else {
                    location.href = `./#/case/caseReport/caseID=${data.id}`;
                }
            } else if (layEvent === 'openReport') { // 查看报告
                layer.msg('还没做=_=');
            }
        });

    });
</script>